String newFilename = filename;
int fileNumber = 1;

while (SD_MMC.exists(newFilename)) {
    fileNumber++;
    newFilename = filename.substring(0, filename.lastIndexOf('_') + 1) + String(fileNumber, DEC) + ".jpg";
}



void loop() {
    unsigned long currentMillis = millis();
    if (currentMillis - previousMillis >= interval) {
        previousMillis = currentMillis;

        if (SD_MMC.begin()) {
            int nextPhotoNumber = 1;
            while (SD_MMC.exists("/photo_" + String(nextPhotoNumber, DEC) + ".jpg")) {
                nextPhotoNumber++;
            }

            String filename = "/photo_" + String(nextPhotoNumber, DEC) + ".jpg";
            takePhoto(filename);
            printAndBuffer(String(gps.location.lat(), 6) + ", " + String(gps.location.lng(), 6));
        } else {
            // Handle SD card absence
            printAndBuffer("SD card not available");
        }
    }

    while (GPSSerial.available()) {
        gps.encode(GPSSerial.read());
    }
}



esp_err_t err = esp_camera_init(&config);
if (err != ESP_OK) {
    // Error handling
}

int nextPhotoNumber = 1;
while (SD_MMC.exists("/photo_" + String(nextPhotoNumber, DEC) + ".jpg")) {
    nextPhotoNumber++;
}

String filename = "/photo_" + String(nextPhotoNumber, DEC) + ".jpg";
takePhoto(filename);
